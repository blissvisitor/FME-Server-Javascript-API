var FMEServer=function(){function e(e){return e=e||null,e?i[e]:i}function t(){var t=e("accept"),n="json";return-1!==t.indexOf("/")&&(t=t.split(/\//g),t[1].length>0&&(n=t[1])),n}function n(){if(e("server")&&e("token"))return!0;throw new Error("You must initialize FMEServer using the FMEServer.init() method.")}function r(t,r,o,i,s,a){if(n()){if(null===r||"function"!=typeof r)throw new Error("A callback function must be defined in order to use the FME Server REST API.");var l;if(o=o||"GET",i=i||null,s=s||null,a=a||e("accept"),t+=-1!=t.indexOf("?")?"&detail="+e("detail"):"?detail="+e("detail"),e("xdomain")){if("GET"!=o)throw new Error("IE8 and IE9 Only support CORS requests through GET methods. Only partial functionality is available.");l=new XDomainRequest,t+="&token="+e("token"),l.open(o,t),l.onload=function(){var e;e=l.responseText;try{e=JSON.parse(e)}catch(t){}finally{r(e)}},l.send()}else l=new XMLHttpRequest,l.open(o,t,!0),l.setRequestHeader("Authorization","fmetoken token="+e("token")),null!==a&&l.setRequestHeader("Accept",a),null!==s&&"attachment"!=s&&l.setRequestHeader("Content-type",s),"attachment"==s&&(l.setRequestHeader("Content-type","application/octet-stream"),l.setRequestHeader("Content-Disposition",'attachment; filename="'+i.name+'"'),i=i.contents),l.onreadystatechange=function(){var e=4;if(l.readyState==e){var t;try{t=l.responseText,0===t.length&&204==l.status?t='{ "delete" : "true" }':0===t.length&&202==l.status&&(t='{ "value" : "true" }'),t=JSON.parse(t)}catch(n){t=l.response}finally{r(t)}}},l.send(i)}}function o(t){return t=t.replace(/{{svr}}/g,e("server")),t=t.replace(/{{ver}}/g,e("version"))}Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=t||0,r=this.length;r>n;n++)if(this[n]===e)return n;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var i={version:"v2"},s={init:function(t,n,r,o,i,s){if(void 0===t||"object"==typeof t&&void 0===t.server)throw new Error("You did not specify a server URL in your configuration paramaters.");if(void 0===n&&"object"==typeof t&&void 0===t.token)throw new Error("You did not specify a token in your configuration paramaters.");"object"==typeof t?(e().server=t.server,e().token=t.token,e().accept=t.format||"application/json",e().detail=t.detail||"high",e().port=t.port||"80",e().ssl=t.ssl||!1,e().xdomain=!1):(e().server=t,e().token=n,e().accept=r||"application/json",e().detail=o||"high",e().port=i||"80",e().ssl=s||!1,e().xdomain=!1),"/"==e("server").charAt(e("server").length-1)&&(e().server=e("server").substr(0,e("server").length-1)),"http"!=e("server").substring(0,4)&&(e().server="http://"+e("server")),e("ssl")&&(e().server=e("server").replace("http://","https://")),location.host==e("server").split("//")[1].split("/")[0]||"Microsoft Internet Explorer"!=navigator.appName||-1===navigator.appVersion.indexOf("MSIE 9")&&-1===navigator.appVersion.indexOf("MSIE 8")||(e().xdomain=!0);var a=["80","443"];-1===a.indexOf(e("port"))&&(e().server=e("server")+":"+e("port"))},getSession:function(t,n,i){i=i||null;var s=o("{{svr}}/fmedataupload/"+t+"/"+n),a="opt_extractarchive=false&opt_pathlevel=3&opt_fullpath=true&token="+e("token");r(s,i,"POST",a,"application/x-www-form-urlencoded")},getWebSocketConnection:function(t,n){n=n||null;var r;r=-1!=e("server").indexOf("https://")?e("server").replace("https://","wss://"):e("server").replace("http://","ws://");var o=new WebSocket(r+":7078/websocket");return o.onopen=function(){var e={ws_op:"open",ws_stream_id:t};o.send(JSON.stringify(e)),null!==n&&n()},o},runDataDownload:function(n,i,s,a){a=a||null;var l=o("{{svr}}/fmedatadownload/"+n+"/"+i);s&&s.length>0&&(s="&"+s),s="opt_responseformat="+t()+"&opt_showresult=true&token="+e("token")+s,r(l,a,"POST",s,"application/x-www-form-urlencoded")},runDataStreaming:function(t,n,i,s){s=s||null;var a=o("{{svr}}/fmedatastreaming/"+t+"/"+n);i="opt_showresult=true&token="+e("token")+"&"+i,r(a,s,"POST",i,"application/x-www-form-urlencoded")},dataUpload:function(t,n,i,s,a){a=a||null,s=s||null;var l=o("{{svr}}/fmedataupload/"+t+"/"+n),c=e("token");if(null!==s&&(l+=";jsessionid="+s),FormData){for(var u=new FormData,p=0;p<i.files.length;p++)u.append("files[]",i.files[p]);l=l+"?token="+c,r(l,a,"POST",u)}else{var f=parseInt(1e8*Math.random()),v=document.createElement("iframe");v.id=f+"-frame",v.name=f,v.style.display="none",document.body.appendChild(v);var m=document.createElement("form");m.action=l+"?token="+c,m.method="POST",m.enctype="multipart/form-data";var d=i.cloneNode(!0);d.name="files[]",d.files=i.files,m.appendChild(d),m.target=f,m.id=f+"-form",m.style.display="none",document.body.appendChild(m),m.submit(),a({submit:!0,id:f})}},getDataUploads:function(e,t,n,i){i=i||null,n=n||null;var s=o("{{svr}}/fmedataupload/"+e+"/"+t+";jsessionid="+n);r(s,i)},runWorkspaceWithData:function(n,i,s){s=s||null,n=n||null;var a=i.service||"fmedatadownload",l=o("{{svr}}/"+a+"/"+repository+"/"+workspace+"?"),c=i.files,u=i.params;i=i.filename+"=%22%22";for(var p in c)i+=n+"/"+c[p].name+"%22%20%22";i+="&"+u+"&opt_responseformat="+t()+"&token="+e("token"),r(l+i,s)},getRepositories:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/repositories");r(t,e)},getRepositoryItems:function(e,t,n){t=t||"",n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/repositories/"+e+"/items?type="+t);r(i,n)},getWorkspaceParameters:function(e,t,n){n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/repositories/"+e+"/items/"+t+"/parameters");r(i,n)},getWorkspaceParameter:function(e,t,n,i){i=i||null;var s=o("{{svr}}/fmerest/{{ver}}/repositories/"+e+"/items/"+t+"/parameters/"+n);r(s,i)},generateFormItems:function(e,t,n){for(var r=document.getElementById(e),o=0;o<t.length;o++){var i=t[o];if(!n||-1!==n.indexOf(i.name)){var s=document.createElement("span");s.setAttribute("class",i.name+" fmes-form-component");var a=document.createElement("label");a.innerHTML=i.description,s.appendChild(a);var l;if("FILE_OR_URL"===i.type||"FILENAME_MUSTEXIST"===i.type||"FILENAME"===i.type)l=document.createElement("input"),l.type="file",l.name=i.name;else if("LISTBOX"===i.type||"LOOKUP_LISTBOX"===i.type){l=document.createElement("div");for(var c=i.listOptions,u=0;u<c.length;u++){var p=c[u],f=document.createElement("input");f.type="checkbox",f.value=p.value,f.name=i.name,l.appendChild(f);var v=document.createElement("label");v.innerHTML=p.caption,l.appendChild(v)}}else if("LOOKUP_CHOICE"===i.type||"STRING_OR_CHOICE"===i.type||"CHOICE"===i.type){l=document.createElement("select"),l.name=i.name;for(var c=i.listOptions,u=0;u<c.length;u++){var p=c[u],m=document.createElement("option");m.innerHTML=p.caption,m.value=p.value,l.appendChild(m)}}else"TEXT_EDIT"===i.type?(l=document.createElement("textarea"),l.name=i.name):"INTEGER"==i.type?(l=document.createElement("input"),l.type="number",l.name=i.name):"PASSWORD"==i.type?(l=document.createElement("input"),l.type="password",l.name=i.name):(l=document.createElement("input"),l.value=i.defaultValue,l.name=i.name);s.appendChild(l),r.appendChild(s)}}},getSchedules:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/schedules");r(t,e)},getScheduleItem:function(e,t,n){n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/schedules/"+e+"/"+t);r(i,n)},enableScheduleItem:function(e,t,n){n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/schedules/"+e+"/"+t+"/enabled"),s="value=true";r(i,n,"PUT",s,"application/x-www-form-urlencoded")},disableScheduleItem:function(e,t,n){n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/schedules/"+e+"/"+t+"/enabled"),s="value=false";r(i,n,"PUT",s,"application/x-www-form-urlencoded")},replaceScheduleItem:function(e,t,n,i){i=i||null;var s=o("{{svr}}/fmerest/{{ver}}/schedules/"+e+"/"+t),a=JSON.stringify(n);r(s,i,"PUT",a,"application/json")},removeScheduleItem:function(e,t,n){n=n||null;var i=o("{{svr}}/fmerest/{{ver}}/schedules/"+e+"/"+t);r(i,n,"DELETE")},createScheduleItem:function(e,t){t=t||null;var n=o("{{svr}}/fmerest/{{ver}}/schedules"),i=JSON.stringify(e);r(n,t,"POST",i,"application/json")},getAllPublications:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/notifications/publications");r(t,e)},getPublication:function(e,t){t=t||null,e=encodeURIComponent(e).replace(/%20/g,"+");var n=o("{{svr}}/fmerest/{{ver}}/notifications/publications/"+e);r(n,t)},createPublication:function(e,t){t=t||null;var n=o("{{svr}}/fmerest/{{ver}}/notifications/publications"),i=JSON.stringify(e);r(n,t,"POST",i,"application/json")},updatePublication:function(e,t,n){n=n||null,e=encodeURIComponent(e).replace(/%20/g,"+");var i=o("{{svr}}/fmerest/{{ver}}/notifications/publications/"+e),s=JSON.stringify(t);r(i,n,"PUT",s,"application/json")},deletePublication:function(e,t){t=t||null,e=encodeURIComponent(e).replace(/%20/g,"+");var n=o("{{svr}}/fmerest/{{ver}}/notifications/publications/"+e);r(n,t,"DELETE")},getPublisherProtocols:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/notifications/publishers/");r(t,e)},queryPublisherProtocol:function(e,t){t=t||null;var n=o("{{svr}}/fmerest/{{ver}}/notifications/publishers/"+e);r(n,t)},getAllSubscriptions:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/notifications/subscriptions");r(t,e)},getSubscription:function(e,t){t=t||null,e=encodeURIComponent(e).replace(/%20/g,"+");var n=o("{{svr}}/fmerest/{{ver}}/notifications/subscriptions/"+e);r(n,t)},createSubscription:function(e,t){t=t||null;var n=o("{{svr}}/fmerest/{{ver}}/notifications/subscriptions"),i=JSON.stringify(e);r(n,t,"POST",i,"application/json")},updateSubscription:function(e,t,n){n=n||null,e=encodeURIComponent(e).replace(/%20/g,"+");var i=o("{{svr}}/fmerest/{{ver}}/notifications/subscription/"+e),s=JSON.stringify(t);r(i,n,"PUT",s,"application/json")},deleteSubscription:function(e,t){t=t||null,e=encodeURIComponent(e).replace(/%20/g,"+");var n=o("{{svr}}/fmerest/{{ver}}/notifications/subscriptions/"+e);r(n,t,"DELETE")},getSubscriberProtocols:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/notifications/subscribers/");r(t,e)},querySubscriberProtocol:function(e,t){t=t||null;var n=o("{{svr}}/fmerest/{{ver}}/notifications/subscribers/"+e);r(n,t)},getNotificationTopics:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/notifications/topics");r(t,e)},getNotificationTopic:function(e,t){t=t||null,e=encodeURIComponent(e);var n=o("{{svr}}/fmerest/{{ver}}/notifications/topics/"+e);r(n,t)},createTopic:function(e,t,n){n=n||null,e=encodeURIComponent(e).replace(/%20/g,"+"),t=encodeURIComponent(t).replace(/%20/g,"+");var i=o("{{svr}}/fmerest/{{ver}}/notifications/topics"),s="name="+e+"&description="+t;r(i,n,"POST",s,"application/x-www-form-urlencoded")},updateTopic:function(e,t,n){n=n||null,e=encodeURIComponent(e),t=encodeURIComponent(t).replace(/%20/g,"+");var i=o("{{svr}}/fmerest/{{ver}}/notifications/topics/"+e),s="description="+t;r(i,n,"PUT",s,"application/x-www-form-urlencoded")},deleteTopic:function(e,t){t=t||null,e=encodeURIComponent(e);var n=o("{{svr}}/fmerest/{{ver}}/notifications/topics/"+e);r(n,t,"DELETE",null,"application/x-www-form-urlencoded")},publishToTopicStructured:function(e,t,n,i){i=i||null,e=encodeURIComponent(e),n=n.toLowerCase()||"json";var s=o("{{svr}}/fmerest/{{ver}}/notifications/topics/"+e+"/message/map");if("xml"==n)n="application/xml";else{n="application/json";try{t=JSON.parse(t),t=JSON.stringify(t)}catch(a){var l={message:"Unable to parse JSON"};return i(l),!1}}r(s,i,"POST",t,n)},publishToTopic:function(e,t,n){n=n||null,e=encodeURIComponent(e);var i=o("{{svr}}/fmerest/{{ver}}/notifications/topics/"+e+"/message/raw");r(i,n,"POST",t,"*/*")},lookupToken:function(e,t,n){n=n||null;var i=o("{{svr}}/fmetoken/service/view.json"),s="user="+e+"&password="+t;r(i,n,"POST",s,"application/x-www-form-urlencoded")},generateToken:function(e,t,n,i,s){s=s||null;var a=o("{{svr}}/fmetoken/service/generate"),l="user="+e+"&password="+t+"&expiration="+n+"&timeunit="+i;r(a,s,"POST",l,"application/x-www-form-urlencoded")},submitJob:function(e,t,n,i){i=i||null;var s=o("{{svr}}/fmerest/{{ver}}/transformations/commands/submit/"+e+"/"+t);n=JSON.stringify(n),r(s,i,"POST",n,"application/json")},submitSyncJob:function(e,t,n,i){i=i||null;var s=o("{{svr}}/fmerest/{{ver}}/transformations/commands/transact/"+e+"/"+t);n=JSON.stringify(n),r(s,i,"POST",n,"application/json")},getResources:function(e){e=e||null;var t=o("{{svr}}/fmerest/{{ver}}/resources");r(t,e)},getResourceDetails:function(e,t,n){n=n||null,t=encodeURIComponent(t).replace(/%2F/g,"/");var i=o("{{svr}}/fmerest/{{ver}}/resources/"+e+"/filesys"+t);r(i,n)},deleteResource:function(e,t,n){n=n||null,t=encodeURIComponent(t).replace(/%2F/g,"/");var i=o("{{svr}}/fmerest/{{ver}}/resources/"+e+"/filesys"+t);r(i,n,"DELETE")},downloadResourceFile:function(t,n){n=encodeURIComponent(n).replace(/%2F/g,"/");var r=o("{{svr}}/fmerest/{{ver}}/resources/"+t+"/filesys"+n+"?accept=contents"),i=document.createElement("iframe");i.style.display="none",document.body.appendChild(i),i.src=r+"&token="+e("token")},uploadResourceFile:function(e,t,n,i,s,a){i=i||null,s=s||!1,a=a||!1,t=encodeURIComponent(t).replace(/%2F/g,"/");var l=o("{{svr}}/fmerest/{{ver}}/resources/"+e+"/filesys"+t);l=l+"?createDirectories="+a+"&overwrite="+s+"&type=FILE",r(l,i,"POST",n,"attachment")},customRequest:function(e,t,n,o,i){n=n||null,o=o||null,t=t.toUpperCase(),i=i||null,r(e,n,t,o,i)}};return s}();