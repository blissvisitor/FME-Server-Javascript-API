var FMEServer=(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(l,m){for(var k=(m||0),h=this.length;k<h;k++){if(this[k]===l){return k}}return -1}}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var d={version:"v2"};function b(h){h=h||null;if(h){return d[h]}return d}function c(){var i=b("accept"),h="json";if(i.indexOf("/")!==-1){i=i.split(/\//g);if(i[1].length>0){h=i[1]}}return h}function g(){if(b("server")&&b("token")){return true}throw new Error("You must initialize FMEServer using the FMEServer.init() method.")}function f(i,n,j,m,l,h){if(g()){if(n===null||typeof n!="function"){throw new Error("A callback function must be defined in order to use the FME Server REST API.")}var k;j=j||"GET";m=m||null;l=l||null;h=h||b("accept");if(i.indexOf("?")!=-1){i+="&detail="+b("detail")}else{i+="?detail="+b("detail")}if(b("xdomain")){if(j=="GET"){k=new XDomainRequest();i+="&token="+b("token");k.open(j,i);k.onload=function(){var p;p=k.responseText;try{p=JSON.parse(p)}catch(o){}finally{n(p)}};k.send()}else{throw new Error("IE8 and IE9 Only support CORS requests through GET methods. Only partial functionality is available.")}}else{k=new XMLHttpRequest();k.open(j,i,true);k.setRequestHeader("Authorization","fmetoken token="+b("token"));if(h!==null){k.setRequestHeader("Accept",h)}if(l!==null&&l!="attachment"){k.setRequestHeader("Content-type",l)}if(l=="attachment"){k.setRequestHeader("Content-type","application/octet-stream");k.setRequestHeader("Content-Disposition",'attachment; filename="'+m.name+'"');m=m.contents}k.onreadystatechange=function(){var o=4;if(k.readyState==o){var q;try{q=k.responseText;if(q.length===0&&k.status==204){q='{ "delete" : "true" }'}else{if(q.length===0&&k.status==202){q='{ "value" : "true" }'}}q=JSON.parse(q)}catch(p){q=k.response}finally{n(q)}}};k.send(m)}}}function a(h){h=h.replace(/{{svr}}/g,b("server"));h=h.replace(/{{ver}}/g,b("version"));return h}var e={init:function(n,k,m,l,i,h){if(n===undefined||(typeof n==="object"&&n.server===undefined)){throw new Error("You did not specify a server URL in your configuration paramaters.")}else{if(k===undefined&&(typeof n==="object"&&n.token===undefined)){throw new Error("You did not specify a token in your configuration paramaters.")}}if(typeof n=="object"){b().server=n.server;b().token=n.token;b().accept=n.format||"application/json";b().detail=n.detail||"high";b().port=n.port||"80";b().ssl=n.ssl||false;b().xdomain=false}else{b().server=n;b().token=k;b().accept=m||"application/json";b().detail=l||"high";b().port=i||"80";b().ssl=h||false;b().xdomain=false}if(b("server").charAt(b("server").length-1)=="/"){b().server=b("server").substr(0,b("server").length-1)}if(b("server").substring(0,4)!="http"){b().server="http://"+b("server")}if(b("ssl")){b().server=b("server").replace("http://","https://")}if(location.host!=b("server").split("//")[1].split("/")[0]&&navigator.appName=="Microsoft Internet Explorer"&&(navigator.appVersion.indexOf("MSIE 9")!==-1||navigator.appVersion.indexOf("MSIE 8")!==-1)){b().xdomain=true}var j=["80","443"];if(j.indexOf(b("port"))===-1){b().server=b("server")+":"+b("port")}},getSession:function(j,h,l){l=l||null;var i=a("{{svr}}/fmedataupload/"+j+"/"+h);var k="opt_extractarchive=false&opt_pathlevel=3&opt_fullpath=true&token="+b("token");f(i,l,"POST",k,"application/x-www-form-urlencoded")},getWebSocketConnection:function(k,j){j=j||null;var i;if(b("server").indexOf("https://")!=-1){i=b("server").replace("https://","wss://")}else{i=b("server").replace("http://","ws://")}var h=new WebSocket(i+":7078/websocket");h.onopen=function(){var l={ws_op:"open",ws_stream_id:k};h.send(JSON.stringify(l));if(j!==null){j()}};return h},runDataDownload:function(j,h,k,l){l=l||null;var i=a("{{svr}}/fmedatadownload/"+j+"/"+h);if(k&&k.length>0){k="&"+k}k="opt_responseformat="+c()+"&opt_showresult=true&token="+b("token")+k;f(i,l,"POST",k,"application/x-www-form-urlencoded")},runDataStreaming:function(j,h,k,l){l=l||null;var i=a("{{svr}}/fmedatastreaming/"+j+"/"+h);k="opt_showresult=true&token="+b("token")+"&"+k;f(i,l,"POST",k,"application/x-www-form-urlencoded")},dataUpload:function(s,m,h,r,u){u=u||null;r=r||null;var j=a("{{svr}}/fmedataupload/"+s+"/"+m);var n=b("token");if(r!==null){j+=";jsessionid="+r}if(!FormData){var l=parseInt(Math.random()*100000000);var p=document.createElement("iframe");p.id=l+"-frame";p.name=l;p.style.display="none";document.body.appendChild(p);var k=document.createElement("form");k.action=j+"?token="+n;k.method="POST";k.enctype="multipart/form-data";var t=h.cloneNode(true);t.name="files[]";t.files=h.files;k.appendChild(t);k.target=l;k.id=l+"-form";k.style.display="none";document.body.appendChild(k);k.submit();u({submit:true,id:l})}else{var o=new FormData();for(var q=0;q<h.files.length;q++){o.append("files[]",h.files[q])}o.append("token",n);f(j,u,"POST",o)}},getDataUploads:function(k,i,h,l){l=l||null;h=h||null;var j=a("{{svr}}/fmedataupload/"+k+"/"+i+";jsessionid="+h);f(j,l)},runWorkspaceWithData:function(m,n,o){o=o||null;m=m||null;var i=n.service||"fmedatadownload";var j=a("{{svr}}/"+i+"/"+repository+"/"+workspace+"?");var k=n.files;var h=n.params;n=n.filename+"=%22%22";for(var l in k){n+=m+"/"+k[l].name+"%22%20%22"}n+="&"+h+"&opt_responseformat="+c()+"&token="+b("token");f(j+n,o)},getRepositories:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/repositories");f(h,i)},getRepositoryItems:function(j,i,k){i=i||"";k=k||null;var h=a("{{svr}}/fmerest/{{ver}}/repositories/"+j+"/items?type="+i);f(h,k)},getWorkspaceParameters:function(j,h,k){k=k||null;var i=a("{{svr}}/fmerest/{{ver}}/repositories/"+j+"/items/"+h+"/parameters");f(i,k)},getWorkspaceParameter:function(j,h,l,k){k=k||null;var i=a("{{svr}}/fmerest/{{ver}}/repositories/"+j+"/items/"+h+"/parameters/"+l);f(i,k)},generateFormItems:function(h,v,p){var j=document.getElementById(h);for(var m=0;m<v.length;m++){var k=v[m];if(!p||p.indexOf(k.name)!==-1){var s=document.createElement("span");s.setAttribute("class",k.name+" fmes-form-component");var r=document.createElement("label");r.innerHTML=k.description;s.appendChild(r);var l;if(k.type==="FILE_OR_URL"||k.type==="FILENAME_MUSTEXIST"||k.type==="FILENAME"){l=document.createElement("input");l.type="file";l.name=k.name}else{if(k.type==="LISTBOX"||k.type==="LOOKUP_LISTBOX"){l=document.createElement("div");var w=k.listOptions;for(var q=0;q<w.length;q++){var n=w[q];var o=document.createElement("input");o.type="checkbox";o.value=n.value;o.name=k.name;l.appendChild(o);var u=document.createElement("label");u.innerHTML=n.caption;l.appendChild(u)}}else{if(k.type==="LOOKUP_CHOICE"||k.type==="STRING_OR_CHOICE"||k.type==="CHOICE"){l=document.createElement("select");l.name=k.name;var w=k.listOptions;for(var q=0;q<w.length;q++){var n=w[q];var t=document.createElement("option");t.innerHTML=n.caption;t.value=n.value;l.appendChild(t)}}else{if(k.type==="TEXT_EDIT"){l=document.createElement("textarea");l.name=k.name}else{if(k.type=="INTEGER"){l=document.createElement("input");l.type="number";l.name=k.name}else{if(k.type=="PASSWORD"){l=document.createElement("input");l.type="password";l.name=k.name}else{l=document.createElement("input");l.value=k.defaultValue;l.name=k.name}}}}}}s.appendChild(l);j.appendChild(s)}}},getSchedules:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules");f(h,i)},getScheduleItem:function(j,i,k){k=k||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules/"+j+"/"+i);f(h,k)},enableScheduleItem:function(j,i,l){l=l||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules/"+j+"/"+i+"/enabled");var k="value=true";f(h,l,"PUT",k,"application/x-www-form-urlencoded")},disableScheduleItem:function(j,i,l){l=l||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules/"+j+"/"+i+"/enabled");var k="value=false";f(h,l,"PUT",k,"application/x-www-form-urlencoded")},replaceScheduleItem:function(j,i,l,m){m=m||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules/"+j+"/"+i);var k=JSON.stringify(l);f(h,m,"PUT",k,"application/json")},removeScheduleItem:function(j,i,k){k=k||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules/"+j+"/"+i);f(h,k,"DELETE")},createScheduleItem:function(j,k){k=k||null;var h=a("{{svr}}/fmerest/{{ver}}/schedules");var i=JSON.stringify(j);f(h,k,"POST",i,"application/json")},getAllPublications:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/publications");f(h,i)},getPublication:function(i,j){j=j||null;i=encodeURIComponent(i).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/publications/"+i);f(h,j)},createPublication:function(h,k){k=k||null;var i=a("{{svr}}/fmerest/{{ver}}/notifications/publications");var j=JSON.stringify(h);f(i,k,"POST",j,"application/json")},updatePublication:function(j,h,l){l=l||null;j=encodeURIComponent(j).replace(/%20/g,"+");var i=a("{{svr}}/fmerest/{{ver}}/notifications/publications/"+j);var k=JSON.stringify(h);f(i,l,"PUT",k,"application/json")},deletePublication:function(i,j){j=j||null;i=encodeURIComponent(i).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/publications/"+i);f(h,j,"DELETE")},getPublisherProtocols:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/publishers/");f(h,i)},queryPublisherProtocol:function(i,j){j=j||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/publishers/"+i);f(h,j)},getAllSubscriptions:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscriptions");f(h,i)},getSubscription:function(i,j){j=j||null;i=encodeURIComponent(i).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscriptions/"+i);f(h,j)},createSubscription:function(i,k){k=k||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscriptions");var j=JSON.stringify(i);f(h,k,"POST",j,"application/json")},updateSubscription:function(i,j,l){l=l||null;i=encodeURIComponent(i).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscription/"+i);var k=JSON.stringify(j);f(h,l,"PUT",k,"application/json")},deleteSubscription:function(i,j){j=j||null;i=encodeURIComponent(i).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscriptions/"+i);f(h,j,"DELETE")},getSubscriberProtocols:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscribers/");f(h,i)},querySubscriberProtocol:function(i,j){j=j||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/subscribers/"+i);f(h,j)},getNotificationTopics:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics");f(h,i)},getNotificationTopic:function(i,j){j=j||null;i=encodeURIComponent(i);var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics/"+i);f(h,j)},createTopic:function(i,j,l){l=l||null;i=encodeURIComponent(i).replace(/%20/g,"+");j=encodeURIComponent(j).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics");var k="name="+i+"&description="+j;f(h,l,"POST",k,"application/x-www-form-urlencoded")},updateTopic:function(i,j,l){l=l||null;i=encodeURIComponent(i);j=encodeURIComponent(j).replace(/%20/g,"+");var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics/"+i);var k="description="+j;f(h,l,"PUT",k,"application/x-www-form-urlencoded")},deleteTopic:function(i,j){j=j||null;i=encodeURIComponent(i);var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics/"+i);f(h,j,"DELETE",null,"application/x-www-form-urlencoded")},publishToTopicStructured:function(i,m,j,n){n=n||null;i=encodeURIComponent(i);j=j.toLowerCase()||"json";var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics/"+i+"/message/map");if(j=="xml"){j="application/xml"}else{j="application/json";try{m=JSON.parse(m);m=JSON.stringify(m)}catch(l){var k={message:"Unable to parse JSON"};n(k);return false}}f(h,n,"POST",m,j)},publishToTopic:function(i,j,k){k=k||null;i=encodeURIComponent(i);var h=a("{{svr}}/fmerest/{{ver}}/notifications/topics/"+i+"/message/raw");f(h,k,"POST",j,"*/*")},lookupToken:function(h,j,l){l=l||null;var i=a("{{svr}}/fmetoken/service/view.json");var k="user="+h+"&password="+j;f(i,l,"POST",k,"application/x-www-form-urlencoded")},generateToken:function(h,j,l,k,n){n=n||null;var i=a("{{svr}}/fmetoken/service/generate");var m="user="+h+"&password="+j+"&expiration="+l+"&timeunit="+k;f(i,n,"POST",m,"application/x-www-form-urlencoded")},submitJob:function(j,h,k,l){l=l||null;var i=a("{{svr}}/fmerest/{{ver}}/transformations/commands/submit/"+j+"/"+h);k=JSON.stringify(k);f(i,l,"POST",k,"application/json")},submitSyncJob:function(j,h,k,l){l=l||null;var i=a("{{svr}}/fmerest/{{ver}}/transformations/commands/transact/"+j+"/"+h);k=JSON.stringify(k);f(i,l,"POST",k,"application/json")},getResources:function(i){i=i||null;var h=a("{{svr}}/fmerest/{{ver}}/resources");f(h,i)},getResourceDetails:function(i,j,k){k=k||null;j=encodeURIComponent(j).replace(/%2F/g,"/");var h=a("{{svr}}/fmerest/{{ver}}/resources/"+i+"/filesys"+j);f(h,k)},deleteResource:function(i,j,k){k=k||null;j=encodeURIComponent(j).replace(/%2F/g,"/");var h=a("{{svr}}/fmerest/{{ver}}/resources/"+i+"/filesys"+j);f(h,k,"DELETE")},downloadResourceFile:function(j,k){k=encodeURIComponent(k).replace(/%2F/g,"/");var h=a("{{svr}}/fmerest/{{ver}}/resources/"+j+"/filesys"+k+"?accept=contents");var i=document.createElement("iframe");i.style.display="none";document.body.appendChild(i);i.src=h+"&token="+b("token")},uploadResourceFile:function(k,l,m,n,i,j){n=n||null;i=i||false;j=j||false;l=encodeURIComponent(l).replace(/%2F/g,"/");var h=a("{{svr}}/fmerest/{{ver}}/resources/"+k+"/filesys"+l);h=h+"?createDirectories="+j+"&overwrite="+i+"&type=FILE";f(h,n,"POST",m,"attachment")},customRequest:function(h,i,l,k,j){l=l||null;k=k||null;i=i.toUpperCase();j=j||null;f(h,l,i,k,j)}};return e}());